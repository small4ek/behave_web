box:
  id: python:3.5
  ports:
    - "5000"

dev:
  steps:
    - pip-install
    - internal/watch:
        code: python behave
        reload: true
        
# Build definition
build:
  # The steps that will be executed on build
  steps:
    - install-packages:
        packages: xvfb chromedriver
    - pip-install


    # A custom script step, name value is used in the UI
    # and the code value contains the command that get executed
    - script:
        name: Enable virtual display
        code: |
          export DISPLAY=:99.0
          start-stop-daemon --start --quiet --pidfile /tmp/xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -screen 0 1024x768x24 -ac +extension GLX +render -noreset
          sleep 3 # give xvfb some time to start
    - script:
        name: behave test
        code: |
          python behave
